# 💰 VEO AI平台 - 商业化运营完整方案

## 📋 目录

- [商业模式概述](#商业模式概述)
- [技术架构](#技术架构)
- [微信登录集成](#微信登录集成)
- [微信支付集成](#微信支付集成)
- [VivaAPI集成](#vivaapi集成)
- [完整业务流程](#完整业务流程)
- [数据库设计](#数据库设计)
- [API实现](#api实现)
- [安全考虑](#安全考虑)
- [运营建议](#运营建议)

---

## 🎯 商业模式概述

### 业务模式

您的VEO AI平台采用**SaaS订阅制 + API转售**的商业模式：

1. **用户注册登录**（微信登录）
2. **购买积分套餐**（微信支付）
3. **使用VEO 3服务**（通过VivaAPI）
4. **按积分消耗计费**

### 盈利模式

```
VivaAPI购买价格 < 您的销售价格 = 利润空间
```

**示例**:
- 您从VivaAPI购买: ¥1/积分
- 您向用户销售: ¥1.5/积分
- 利润率: 50%

---

## 🏗️ 技术架构

### 系统架构图

```
┌─────────────────────────────────────────────────────┐
│                     用户层                           │
│  微信小程序/H5 → 网站前端 → 视频生成界面             │
└─────────────────┬───────────────────────────────────┘
                  │
┌─────────────────┴───────────────────────────────────┐
│                   应用层                             │
│  ┌──────────┐  ┌──────────┐  ┌─────────────┐       │
│  │微信登录  │  │微信支付  │  │VivaAPI调用  │       │
│  │  OAuth   │  │  JSAPI   │  │  VEO 3 API  │       │
│  └──────────┘  └──────────┘  └─────────────┘       │
└─────────────────┬───────────────────────────────────┘
                  │
┌─────────────────┴───────────────────────────────────┐
│                   数据层                             │
│  用户表 │ 订单表 │ 积分表 │ API调用记录表           │
└─────────────────────────────────────────────────────┘
```

### 技术栈

- **前端**: Next.js 15 + React
- **后端**: Next.js API Routes
- **数据库**: PostgreSQL (Supabase)
- **支付**: 微信支付
- **视频生成**: VivaAPI (VEO 3)
- **认证**: NextAuth.js (微信OAuth)

---

## 🔐 微信登录集成

### 1. 前置准备

#### 申请微信开放平台账号

1. **访问**: https://open.weixin.qq.com
2. **注册**: 企业账号（需要营业执照）
3. **创建网站应用**: 
   - 应用名称: VEO AI视频生成平台
   - 应用域名: your-domain.com
   - 审核周期: 7-15天

#### 获取配置信息

登录后获取:
- `AppID`: 应用唯一标识
- `AppSecret`: 应用密钥

### 2. 代码实现

#### 更新NextAuth配置

文件: `src/lib/auth.ts`

```typescript
import WeChatProvider from "next-auth/providers/wechat"

export const authOptions: NextAuthOptions = {
  providers: [
    // 微信登录 - 网页版
    WeChatProvider({
      clientId: process.env.WECHAT_APP_ID!,
      clientSecret: process.env.WECHAT_APP_SECRET!,
      authorization: {
        url: "https://open.weixin.qq.com/connect/qrconnect",
        params: {
          scope: "snsapi_login",
          // 回调地址会自动配置
        }
      },
      userinfo: "https://api.weixin.qq.com/sns/userinfo",
      profile(profile) {
        return {
          id: profile.unionid,
          name: profile.nickname,
          email: `${profile.unionid}@wechat.user`,
          image: profile.headimgurl,
        }
      },
    }),
    
    // 保留其他登录方式
    // ...
  ],
  
  callbacks: {
    async signIn({ user, account, profile }) {
      if (account?.provider === "wechat") {
        // 检查用户是否已存在
        const existingUser = await pool.query(
          'SELECT * FROM users WHERE wechat_unionid = $1',
          [profile?.unionid]
        )

        if (existingUser.rows.length === 0) {
          // 新用户，创建账户并赠送10积分
          const client = await pool.connect()
          try {
            await client.query('BEGIN')

            const userResult = await client.query(
              `INSERT INTO users (email, name, avatar, wechat_unionid, wechat_openid)
               VALUES ($1, $2, $3, $4, $5)
               RETURNING id`,
              [
                `${profile?.unionid}@wechat.user`,
                profile?.nickname,
                profile?.headimgurl,
                profile?.unionid,
                profile?.openid
              ]
            )

            const userId = userResult.rows[0].id

            // 创建积分账户并赠送10积分
            await client.query(
              `INSERT INTO user_credit_accounts 
               (user_id, available_credits, total_credits)
               VALUES ($1, 10, 10)`,
              [userId]
            )

            await client.query('COMMIT')
          } catch (error) {
            await client.query('ROLLBACK')
            throw error
          } finally {
            client.release()
          }
        }
      }
      return true
    },
  },
}
```

#### 环境变量配置

文件: `.env`

```env
# 微信登录配置
WECHAT_APP_ID="wx1234567890abcdef"
WECHAT_APP_SECRET="1a2b3c4d5e6f7g8h9i0j1k2l3m4n5o6p"
```

### 3. 前端登录按钮

文件: `src/app/login/page.tsx`

```tsx
import { signIn } from "next-auth/react"

<Button
  onClick={() => signIn('wechat', { callbackUrl: '/' })}
  className="w-full bg-green-500 hover:bg-green-600"
>
  <svg className="w-5 h-5 mr-2" viewBox="0 0 24 24">
    {/* 微信图标 */}
  </svg>
  微信登录
</Button>
```

---

## 💳 微信支付集成

### 1. 前置准备

#### 开通微信支付商户号

1. **访问**: https://pay.weixin.qq.com
2. **注册**: 微信支付商户号（需要营业执照、银行账户）
3. **获取配置**:
   - 商户号 (MchID)
   - API密钥 (API Key V3)
   - 商户证书

#### 安全配置

- 下载商户证书（apiclient_cert.pem和apiclient_key.pem）
- 保存到安全位置，不要提交到Git

### 2. 安装SDK

```bash
npm install wechatpay-node-v3
```

### 3. 创建支付API

#### 文件: `src/app/api/payment/create-order/route.ts`

```typescript
import { NextRequest, NextResponse } from "next/server"
import { getServerSession } from "next-auth/next"
import { authOptions } from "@/lib/auth"
import { Payment } from "wechatpay-node-v3"
import { pool } from "@/lib/db"
import crypto from "crypto"

// 初始化微信支付
const payment = new Payment({
  appid: process.env.WECHAT_APP_ID!,
  mchid: process.env.WECHAT_MCH_ID!,
  private_key: process.env.WECHAT_PRIVATE_KEY!, // 商户私钥
  serial_no: process.env.WECHAT_SERIAL_NO!, // 证书序列号
  apiv3_private_key: process.env.WECHAT_APIV3_KEY!, // APIv3密钥
  notify_url: `${process.env.NEXTAUTH_URL}/api/payment/notify`, // 支付回调地址
})

export async function POST(request: NextRequest) {
  try {
    const session = await getServerSession(authOptions)
    if (!session?.user?.email) {
      return NextResponse.json({ error: "未登录" }, { status: 401 })
    }

    const { packageId } = await request.json()

    // 查询套餐信息
    const packageResult = await pool.query(
      'SELECT * FROM credit_packages WHERE id = $1 AND is_active = true',
      [packageId]
    )

    if (packageResult.rows.length === 0) {
      return NextResponse.json({ error: "套餐不存在" }, { status: 404 })
    }

    const pkg = packageResult.rows[0]

    // 查询用户ID
    const userResult = await pool.query(
      'SELECT id FROM users WHERE email = $1',
      [session.user.email]
    )
    const userId = userResult.rows[0].id

    // 创建订单
    const orderNo = `ORD${Date.now()}${crypto.randomBytes(4).toString('hex').toUpperCase()}`
    
    const orderResult = await pool.query(
      `INSERT INTO orders 
       (order_no, user_id, package_id, package_name, credits, amount, status, created_at)
       VALUES ($1, $2, $3, $4, $5, $6, 'PENDING', NOW())
       RETURNING id`,
      [orderNo, userId, packageId, pkg.name, pkg.credits, pkg.price]
    )

    const orderId = orderResult.rows[0].id

    // 调用微信支付统一下单
    const result = await payment.native({
      description: pkg.name,
      out_trade_no: orderNo,
      amount: {
        total: Math.round(pkg.price * 100), // 单位：分
        currency: 'CNY'
      },
      attach: JSON.stringify({ orderId, userId }),
    })

    // 返回支付二维码URL
    return NextResponse.json({
      success: true,
      orderId,
      orderNo,
      qrCode: result.code_url, // 二维码内容
      amount: pkg.price,
      packageName: pkg.name,
      credits: pkg.credits
    })

  } catch (error) {
    console.error('创建订单失败:', error)
    return NextResponse.json({ error: "创建订单失败" }, { status: 500 })
  }
}
```

#### 文件: `src/app/api/payment/notify/route.ts`

```typescript
import { NextRequest, NextResponse } from "next/server"
import { Payment } from "wechatpay-node-v3"
import { pool } from "@/lib/db"

const payment = new Payment({
  // ... 同上配置
})

export async function POST(request: NextRequest) {
  try {
    const body = await request.text()
    const signature = request.headers.get('wechatpay-signature')
    const timestamp = request.headers.get('wechatpay-timestamp')
    const nonce = request.headers.get('wechatpay-nonce')
    const serial = request.headers.get('wechatpay-serial')

    // 验证签名
    const isValid = payment.verifySign({
      body,
      signature: signature!,
      serial: serial!,
      nonce: nonce!,
      timestamp: timestamp!,
    })

    if (!isValid) {
      return NextResponse.json({ code: 'FAIL', message: '签名验证失败' })
    }

    // 解密数据
    const data = JSON.parse(body)
    const decrypted = payment.decipher_gcm(
      data.resource.ciphertext,
      data.resource.associated_data,
      data.resource.nonce
    )

    const paymentData = JSON.parse(decrypted)

    // 处理支付成功
    if (paymentData.trade_state === 'SUCCESS') {
      const orderNo = paymentData.out_trade_no
      const attach = JSON.parse(paymentData.attach)

      const client = await pool.connect()
      try {
        await client.query('BEGIN')

        // 更新订单状态
        const orderResult = await client.query(
          `UPDATE orders 
           SET status = 'PAID', 
               transaction_id = $1,
               paid_at = NOW()
           WHERE order_no = $2
           RETURNING credits, user_id`,
          [paymentData.transaction_id, orderNo]
        )

        if (orderResult.rows.length > 0) {
          const { credits, user_id } = orderResult.rows[0]

          // 增加用户积分
          await client.query(
            `UPDATE user_credit_accounts 
             SET available_credits = available_credits + $1,
                 total_credits = total_credits + $1
             WHERE user_id = $2`,
            [credits, user_id]
          )

          // 记录积分交易
          await client.query(
            `INSERT INTO credit_transactions 
             (user_id, type, amount, description, created_at)
             VALUES ($1, 'PURCHASE', $2, $3, NOW())`,
            [user_id, credits, `购买套餐：${paymentData.description}`]
          )
        }

        await client.query('COMMIT')
      } catch (error) {
        await client.query('ROLLBACK')
        throw error
      } finally {
        client.release()
      }
    }

    return NextResponse.json({ code: 'SUCCESS', message: '成功' })

  } catch (error) {
    console.error('处理支付回调失败:', error)
    return NextResponse.json({ code: 'FAIL', message: '处理失败' })
  }
}
```

### 4. 前端支付流程

#### 文件: `src/app/credits/page.tsx`

```typescript
const handlePurchase = async (packageId: string) => {
  try {
    // 创建订单
    const response = await fetch('/api/payment/create-order', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ packageId })
    })

    const data = await response.json()

    if (data.success) {
      // 显示支付二维码弹窗
      setPaymentQrCode(data.qrCode)
      setShowPaymentModal(true)
      
      // 开始轮询订单状态
      startPollingOrderStatus(data.orderId)
    }
  } catch (error) {
    alert('创建订单失败')
  }
}

const startPollingOrderStatus = (orderId: string) => {
  const interval = setInterval(async () => {
    const response = await fetch(`/api/payment/check-status?orderId=${orderId}`)
    const data = await response.json()

    if (data.status === 'PAID') {
      clearInterval(interval)
      setShowPaymentModal(false)
      alert('支付成功！积分已到账')
      // 刷新积分
      fetchCreditsData()
    }
  }, 2000) // 每2秒查询一次

  // 5分钟后停止轮询
  setTimeout(() => clearInterval(interval), 300000)
}
```

#### 支付二维码弹窗组件

```tsx
{showPaymentModal && (
  <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
    <div className="bg-white rounded-lg p-8 max-w-md">
      <h3 className="text-2xl font-bold mb-4">微信扫码支付</h3>
      <div className="flex justify-center mb-4">
        <QRCodeSVG value={paymentQrCode} size={256} />
      </div>
      <p className="text-center text-gray-600">
        请使用微信扫描二维码完成支付
      </p>
      <Button onClick={() => setShowPaymentModal(false)} className="w-full mt-4">
        取消支付
      </Button>
    </div>
  </div>
)}
```

### 5. 环境变量配置

```env
# 微信支付配置
WECHAT_MCH_ID="1234567890"
WECHAT_SERIAL_NO="5F2E8A1B3C4D5E6F7A8B9C0D1E2F3A4B5C6D7E8F"
WECHAT_APIV3_KEY="your_apiv3_key_32_characters_long"
WECHAT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC...\n-----END PRIVATE KEY-----"
```

---

## 🔌 VivaAPI集成

### 1. 关于VivaAPI

**VivaAPI** (https://www.vivaapi.cn) 是一个AI API聚合平台，提供：
- VEO 3视频生成API
- 其他AI模型API
- 统一的调用接口
- 按使用量计费

### 2. 获取VivaAPI Token

1. **注册账号**: 访问 https://www.vivaapi.cn
2. **充值**: 购买API调用额度
3. **获取Token**: 在控制台 https://www.vivaapi.cn/console/token 获取API Token

### 3. VivaAPI调用示例

#### 更新视频生成API

文件: `src/app/api/generate/video/route.ts`

```typescript
// VivaAPI配置
const VIVA_API_URL = process.env.VIVA_API_URL || "https://api.vivaapi.cn/api/v1"
const VIVA_API_TOKEN = process.env.VIVA_API_TOKEN

// 调用VivaAPI生成视频
async function callVivaAPI(options: {
  prompt: string
  images: string[]
  videoId: string
  aspectRatio?: string
}) {
  try {
    if (!VIVA_API_TOKEN) {
      throw new Error("VivaAPI Token未配置")
    }

    const { prompt, images, aspectRatio = "16:9" } = options

    // 构建请求
    const payload = {
      model: "veo-3", // VivaAPI的VEO 3模型标识
      prompt,
      aspect_ratio: aspectRatio,
      image_urls: images.length > 0 ? images : undefined
    }

    logger.info("调用VivaAPI", { prompt, aspectRatio })

    const response = await fetch(`${VIVA_API_URL}/video/generate`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${VIVA_API_TOKEN}`
      },
      body: JSON.stringify(payload),
      signal: AbortSignal.timeout(30000)
    })

    if (!response.ok) {
      const errorData = await response.json().catch(() => ({}))
      throw new Error(errorData.message || `VivaAPI错误: ${response.status}`)
    }

    const result = await response.json()
    
    // VivaAPI响应格式可能类似:
    // { success: true, task_id: "xxx", status: "processing" }
    
    if (!result.success || !result.task_id) {
      throw new Error("VivaAPI返回数据格式错误")
    }

    logger.info("VivaAPI调用成功", { taskId: result.task_id })
    
    return {
      success: true,
      taskId: result.task_id
    }

  } catch (error) {
    logger.error("VivaAPI调用失败", { 
      error: error instanceof Error ? error.message : String(error) 
    })
    return {
      success: false,
      error: error instanceof Error ? error.message : "VivaAPI调用失败"
    }
  }
}

// 检查VivaAPI状态
async function checkVivaAPIStatus(taskId: string) {
  try {
    const response = await fetch(
      `${VIVA_API_URL}/video/status/${taskId}`,
      {
        headers: {
          'Authorization': `Bearer ${VIVA_API_TOKEN}`
        }
      }
    )

    const result = await response.json()
    
    // 根据VivaAPI的实际响应格式调整
    if (result.status === 'completed') {
      return {
        success: true,
        status: 'completed',
        videoUrl: result.video_url,
        error: null
      }
    } else if (result.status === 'failed') {
      return {
        success: true,
        status: 'failed',
        videoUrl: null,
        error: result.error || '生成失败'
      }
    } else {
      return {
        success: true,
        status: 'processing',
        videoUrl: null,
        error: null
      }
    }

  } catch (error) {
    return {
      success: false,
      error: "状态查询失败"
    }
  }
}
```

### 4. 环境变量配置

```env
# VivaAPI配置
VIVA_API_URL="https://api.vivaapi.cn/api/v1"
VIVA_API_TOKEN="your_viva_api_token_here"
```

### 5. 成本控制策略

#### 方案A：直接透传（简单）

```
用户消耗1积分 → 调用VivaAPI消耗对应额度
```

**优点**: 实现简单
**缺点**: 需要实时充值VivaAPI

#### 方案B：预购批量（推荐）

```
1. 预先在VivaAPI充值大额（如¥10000）
2. 设置用户积分价格（¥1.5/积分）
3. 赚取差价（50%利润）
4. 定期监控VivaAPI余额
```

**实现**:

```typescript
// 定期检查VivaAPI余额
async function checkVivaAPIBalance() {
  const response = await fetch(`${VIVA_API_URL}/account/balance`, {
    headers: { 'Authorization': `Bearer ${VIVA_API_TOKEN}` }
  })
  
  const data = await response.json()
  
  if (data.balance < 1000) { // 余额低于¥1000
    // 发送告警邮件/短信
    sendAlert('VivaAPI余额不足，请及时充值')
  }
}

// 每小时检查一次
setInterval(checkVivaAPIBalance, 3600000)
```

---

## 🔄 完整业务流程

### 用户购买到使用的完整流程

```mermaid
sequenceDiagram
    participant U as 用户
    participant F as 前端
    participant B as 后端
    participant WX as 微信支付
    participant V as VivaAPI
    participant DB as 数据库

    %% 登录流程
    U->>F: 点击微信登录
    F->>WX: OAuth授权
    WX-->>U: 扫码授权
    WX-->>B: 返回用户信息
    B->>DB: 创建/查询用户
    DB-->>B: 用户ID
    B->>DB: 赠送10积分（新用户）
    B-->>F: 登录成功

    %% 购买流程
    U->>F: 选择套餐购买
    F->>B: 创建订单
    B->>DB: 保存订单(PENDING)
    B->>WX: 调用统一下单API
    WX-->>B: 返回支付二维码
    B-->>F: 返回二维码URL
    F-->>U: 显示支付二维码
    U->>WX: 扫码支付
    WX->>B: 支付成功回调
    B->>DB: 更新订单(PAID)
    B->>DB: 增加用户积分
    B-->>WX: 返回成功
    F->>B: 轮询订单状态
    B-->>F: 支付成功
    F-->>U: 显示成功，积分已到账

    %% 使用流程
    U->>F: 输入视频描述，点击生成
    F->>B: 调用生成API
    B->>DB: 检查用户积分
    DB-->>B: 积分充足
    B->>DB: 扣除5积分
    B->>V: 调用VivaAPI生成视频
    V-->>B: 返回taskId
    B->>DB: 保存任务记录
    B-->>F: 返回taskId
    F->>B: 轮询任务状态
    B->>V: 查询VivaAPI状态
    V-->>B: 返回状态
    B-->>F: 返回状态
    
    %% 生成完成
    V->>V: 视频生成完成
    F->>B: 查询状态
    B->>V: 获取最新状态
    V-->>B: completed + 视频URL
    B->>DB: 更新任务状态
    B-->>F: 返回视频URL
    F-->>U: 显示视频
```

---

## 🗄️ 数据库设计

### 新增表结构

#### 订单表 (orders)

```sql
CREATE TABLE orders (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  order_no VARCHAR(50) UNIQUE NOT NULL,
  user_id UUID REFERENCES users(id),
  package_id UUID REFERENCES credit_packages(id),
  package_name VARCHAR(100),
  credits INTEGER NOT NULL,
  amount DECIMAL(10,2) NOT NULL,
  status VARCHAR(20) NOT NULL, -- PENDING, PAID, CANCELLED, REFUNDED
  transaction_id VARCHAR(100), -- 微信支付交易号
  payment_method VARCHAR(20) DEFAULT 'WECHAT_PAY',
  created_at TIMESTAMP DEFAULT NOW(),
  paid_at TIMESTAMP,
  cancelled_at TIMESTAMP
);

CREATE INDEX idx_orders_user_id ON orders(user_id);
CREATE INDEX idx_orders_status ON orders(status);
CREATE INDEX idx_orders_order_no ON orders(order_no);
```

#### 用户表新增字段

```sql
ALTER TABLE users ADD COLUMN wechat_unionid VARCHAR(100) UNIQUE;
ALTER TABLE users ADD COLUMN wechat_openid VARCHAR(100);
ALTER TABLE users ADD COLUMN wechat_nickname VARCHAR(100);

CREATE INDEX idx_users_wechat_unionid ON users(wechat_unionid);
```

---

## 🔐 安全考虑

### 1. 支付安全

- ✅ 使用HTTPS
- ✅ 验证微信签名
- ✅ 订单防重放
- ✅ 金额校验
- ✅ 异步回调验证

### 2. API安全

- ✅ VivaAPI Token加密存储
- ✅ 请求限流
- ✅ 错误重试机制
- ✅ 日志记录所有调用

### 3. 数据安全

- ✅ 用户隐私数据加密
- ✅ 定期备份数据库
- ✅ 敏感信息脱敏
- ✅ SQL注入防护

---

## 💡 运营建议

### 1. 定价策略

#### 套餐设计

| 套餐名称 | 积分 | 售价 | VivaAPI成本 | 利润 | 利润率 |
|---------|------|------|-------------|------|--------|
| 体验版 | 10 | ¥9.9 | ¥5 | ¥4.9 | 98% |
| 基础版 | 50 | ¥39 | ¥25 | ¥14 | 56% |
| 专业版 | 200 | ¥129 | ¥100 | ¥29 | 29% |
| 企业版 | 1000 | ¥499 | ¥500 | -¥1 | -0.2% |

**策略**:
- 体验版：高利润吸引新用户
- 基础版/专业版：主力套餐
- 企业版：保本引流大客户

### 2. 推广策略

1. **新用户福利**
   - 注册送10积分
   - 首次购买8折

2. **分销返利**
   - 邀请好友奖励
   - 多级分销系统

3. **会员制度**
   - 月卡/年卡
   - VIP享折扣

### 3. 成本控制

#### 监控VivaAPI消耗

```typescript
// 每日成本报告
async function generateDailyCostReport() {
  const today = new Date().toISOString().split('T')[0]
  
  // 统计今日生成视频数量
  const result = await pool.query(
    `SELECT COUNT(*) as count, SUM(credits_consumed) as total_credits
     FROM video_generations
     WHERE DATE(created_at) = $1 AND status = 'COMPLETED'`,
    [today]
  )
  
  const { count, total_credits } = result.rows[0]
  
  // VivaAPI成本（假设1积分 = ¥0.5）
  const vivaAPICost = total_credits * 0.5
  
  // 用户充值收入
  const incomeResult = await pool.query(
    `SELECT SUM(amount) as total_income
     FROM orders
     WHERE DATE(paid_at) = $1 AND status = 'PAID'`,
    [today]
  )
  
  const totalIncome = incomeResult.rows[0].total_income || 0
  const profit = totalIncome - vivaAPICost
  
  console.log(`
    📊 ${today} 运营数据:
    视频生成: ${count}个
    积分消耗: ${total_credits}分
    VivaAPI成本: ¥${vivaAPICost}
    用户充值: ¥${totalIncome}
    净利润: ¥${profit}
    利润率: ${((profit/totalIncome)*100).toFixed(2)}%
  `)
  
  return { count, total_credits, vivaAPICost, totalIncome, profit }
}
```

### 4. 用户留存

1. **积分过期提醒**
2. **优惠活动推送**
3. **新功能体验邀请**
4. **客服快速响应**

---

## 📝 实施检查清单

### 阶段1：基础配置

- [ ] 申请微信开放平台账号
- [ ] 获取微信AppID和AppSecret
- [ ] 申请微信支付商户号
- [ ] 获取商户号和证书
- [ ] 注册VivaAPI账号
- [ ] 充值VivaAPI（建议¥1000起）
- [ ] 获取VivaAPI Token

### 阶段2：代码开发

- [ ] 集成微信登录
- [ ] 实现微信支付下单
- [ ] 实现支付回调处理
- [ ] 集成VivaAPI调用
- [ ] 实现订单管理
- [ ] 实现积分充值
- [ ] 添加支付二维码展示

### 阶段3：测试验证

- [ ] 测试微信登录流程
- [ ] 测试支付流程（小额）
- [ ] 测试积分到账
- [ ] 测试VivaAPI调用
- [ ] 测试视频生成
- [ ] 测试异常情况处理

### 阶段4：上线运营

- [ ] 购买域名并备案
- [ ] 部署到生产环境
- [ ] 配置HTTPS证书
- [ ] 设置监控告警
- [ ] 准备客服系统
- [ ] 开始推广运营

---

## 🎯 总结

### 核心优势

1. **完整闭环**: 登录 → 支付 → 使用 → 消费
2. **技术成熟**: Next.js + 微信 + VivaAPI
3. **盈利模式清晰**: API转售赚取差价
4. **可扩展**: 易于添加新功能

### 预期收益

**月度预估（保守）**:
- 用户数: 1000人
- 平均消费: ¥50/人
- 总收入: ¥50,000
- VivaAPI成本: ¥30,000
- **净利润: ¥20,000**

**月度预估（乐观）**:
- 用户数: 5000人
- 平均消费: ¥100/人
- 总收入: ¥500,000
- VivaAPI成本: ¥300,000
- **净利润: ¥200,000**

---

**祝您的VEO AI平台商业化运营成功！** 🚀💰

如有任何问题，欢迎随时咨询！


