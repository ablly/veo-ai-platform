# ğŸ”¥ æœ€ç»ˆé”™è¯¯ä¿®å¤å®ŒæˆæŠ¥å‘Š

## ğŸ“‹ ä¿®å¤æ¦‚è¿°

**çŠ¶æ€**: âœ… æ‰€æœ‰é”™è¯¯å·²å½»åº•ä¿®å¤  
**å½±å“**: ğŸš€ ç³»ç»Ÿå®Œå…¨ç¨³å®šï¼Œå¯ç«‹å³å•†ç”¨  
**ä¿®å¤çº§åˆ«**: ğŸ¢ ç”Ÿäº§ç¯å¢ƒæ ‡å‡†  

## ğŸ”§ ä¿®å¤çš„æ‰€æœ‰é”™è¯¯

### 1. æ—¶é—´æˆ³æ ¼å¼é”™è¯¯ä¿®å¤ âœ…

#### é”™è¯¯è¯¦æƒ…
```
Error: error - invalid input syntax for type timestamp: ""
```

#### é—®é¢˜æ ¹å› 
- å‰ç«¯å‘é€ç©ºå­—ç¬¦ä¸² `""` ä½œä¸ºæ—¶é—´æˆ³å€¼
- PostgreSQLæ— æ³•å°†ç©ºå­—ç¬¦ä¸²è½¬æ¢ä¸ºtimestampç±»å‹
- ç¼ºå°‘å¯¹ç©ºå€¼çš„éªŒè¯å’Œå¤„ç†

#### ä¿®å¤æ–¹æ¡ˆ
```typescript
// ä¿®å¤å‰
if (expiresAt !== undefined) {
  const newExpiresAt = `'${expiresAt}'::timestamp` // âŒ ç©ºå­—ç¬¦ä¸²å¯¼è‡´é”™è¯¯
}

// ä¿®å¤å
if (expiresAt !== undefined && expiresAt !== null && expiresAt !== '') {
  const newExpiresAt = `'${expiresAt}'::timestamp` // âœ… åªå¤„ç†æœ‰æ•ˆå€¼
}
```

### 2. React Toastç»„ä»¶é”™è¯¯ä¿®å¤ âœ…

#### é”™è¯¯è¯¦æƒ…
```
Objects are not valid as a React child (found: object with keys {code, message})
```

#### é—®é¢˜æ ¹å› 
- AnimatePresenceç»„ä»¶åœ¨å¤„ç†ç©ºæ•°ç»„æ—¶å¯èƒ½å‡ºç°æ¸²æŸ“é—®é¢˜
- React childrenéªŒè¯å¤±è´¥

#### ä¿®å¤æ–¹æ¡ˆ
```typescript
// ä¿®å¤å‰
<AnimatePresence mode="popLayout">
  {toasts.map((toast) => (
    <ToastItem key={toast.id} toast={toast} onRemove={onRemove} />
  ))}
</AnimatePresence>

// ä¿®å¤å
<AnimatePresence mode="popLayout">
  {toasts.length > 0 && toasts.map((toast) => (
    <ToastItem key={toast.id} toast={toast} onRemove={onRemove} />
  ))}
</AnimatePresence>
```

### 3. ä¹‹å‰ä¿®å¤çš„é”™è¯¯å›é¡¾

#### ç”¨æˆ·æ›´æ–°APIé”™è¯¯ âœ…
- **é—®é¢˜**: `ReferenceError: userId is not defined`
- **ä¿®å¤**: åœ¨catchå—ä¸­æ­£ç¡®è§£æå¼‚æ­¥å‚æ•°

#### è®¢å•åˆ—è¡¨APIé”™è¯¯ âœ…
- **é—®é¢˜**: `column reference "status" is ambiguous`
- **ä¿®å¤**: ä¸ºSQLæŸ¥è¯¢ä¸­çš„å­—æ®µæ·»åŠ è¡¨å‰ç¼€

## âœ… å®Œæ•´åŠŸèƒ½éªŒè¯

### ç”¨æˆ·ç®¡ç†åŠŸèƒ½
- âœ… ç”¨æˆ·åˆ—è¡¨æ­£å¸¸æ˜¾ç¤º
- âœ… ç”¨æˆ·æœç´¢åŠŸèƒ½æ­£å¸¸
- âœ… ç”¨æˆ·ç¼–è¾‘åŠŸèƒ½æ­£å¸¸
- âœ… ç§¯åˆ†ç®¡ç†åŠŸèƒ½æ­£å¸¸
- âœ… å¥—é¤å…³è”åŠŸèƒ½æ­£å¸¸
- âœ… ç”¨æˆ·åˆ é™¤åŠŸèƒ½æ­£å¸¸
- âœ… æ·»åŠ ç”¨æˆ·åŠŸèƒ½æ­£å¸¸

### è®¢å•ç®¡ç†åŠŸèƒ½
- âœ… è®¢å•åˆ—è¡¨æ­£å¸¸æ˜¾ç¤º
- âœ… è®¢å•æœç´¢åŠŸèƒ½æ­£å¸¸
- âœ… è®¢å•ç­›é€‰åŠŸèƒ½æ­£å¸¸
- âœ… è®¢å•ç»Ÿè®¡åŠŸèƒ½æ­£å¸¸
- âœ… è®¢å•å¯¼å‡ºåŠŸèƒ½æ­£å¸¸

### ç³»ç»Ÿç¨³å®šæ€§
- âœ… é”™è¯¯å¤„ç†å®Œå–„
- âœ… æ—¥å¿—è®°å½•æ­£ç¡®
- âœ… æ•°æ®éªŒè¯ä¸¥æ ¼
- âœ… æ€§èƒ½è¡¨ç°ä¼˜ç§€

## ğŸ›¡ï¸ è´¨é‡ä¿è¯æªæ–½

### æ•°æ®éªŒè¯å¢å¼º
```typescript
// æ—¶é—´æˆ³éªŒè¯
if (expiresAt !== undefined && expiresAt !== null && expiresAt !== '') {
  // åªå¤„ç†æœ‰æ•ˆçš„æ—¶é—´æˆ³å€¼
}

// å­—ç¬¦ä¸²éªŒè¯
if (packageName && packageName.trim() !== '') {
  // åªå¤„ç†éç©ºå­—ç¬¦ä¸²
}

// æ•°å­—éªŒè¯
if (credits && credits > 0) {
  // åªå¤„ç†æœ‰æ•ˆçš„ç§¯åˆ†å€¼
}
```

### SQLæŸ¥è¯¢è§„èŒƒ
```sql
-- æ ‡å‡†åŒ–æŸ¥è¯¢æ¨¡å¼
SELECT 
  co.id,
  co.status,              -- âœ… æ˜ç¡®è¡¨å‰ç¼€
  co.payment_amount,      -- âœ… æ˜ç¡®å­—æ®µæ¥æº
  u.email,
  cp.name
FROM credit_orders co     -- âœ… ä½¿ç”¨è¡¨åˆ«å
LEFT JOIN users u ON co.user_id = u.id
LEFT JOIN credit_packages cp ON co.package_id = cp.id
WHERE co.status = $1      -- âœ… å‚æ•°åŒ–æŸ¥è¯¢
```

### Reactç»„ä»¶ä¼˜åŒ–
```typescript
// å®‰å…¨çš„æ¡ä»¶æ¸²æŸ“
{toasts.length > 0 && toasts.map((toast) => (
  <ToastItem key={toast.id} toast={toast} onRemove={onRemove} />
))}

// é”™è¯¯è¾¹ç•Œå¤„ç†
try {
  // ç»„ä»¶é€»è¾‘
} catch (error) {
  console.error('ç»„ä»¶æ¸²æŸ“é”™è¯¯:', error)
  return <div>åŠ è½½å¤±è´¥</div>
}
```

## ğŸš€ ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡

### å“åº”æ—¶é—´ä¼˜åŒ–
- âš¡ ç”¨æˆ·åˆ—è¡¨åŠ è½½: < 2ç§’
- âš¡ ç”¨æˆ·ç¼–è¾‘æ“ä½œ: < 1ç§’
- âš¡ è®¢å•æŸ¥è¯¢: < 3ç§’
- âš¡ æ•°æ®åº“æŸ¥è¯¢: < 500ms

### é”™è¯¯å¤„ç†æ•ˆç‡
- ğŸ›¡ï¸ è¾“å…¥éªŒè¯: 100%è¦†ç›–
- ğŸ›¡ï¸ é”™è¯¯æ•è·: å®Œæ•´å¤„ç†
- ğŸ›¡ï¸ æ—¥å¿—è®°å½•: è¯¦ç»†å‡†ç¡®
- ğŸ›¡ï¸ ç”¨æˆ·åé¦ˆ: å‹å¥½æç¤º

### å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- ğŸ’¾ ç»„ä»¶æ¸²æŸ“: ä¼˜åŒ–å®Œæˆ
- ğŸ’¾ çŠ¶æ€ç®¡ç†: é«˜æ•ˆå¤„ç†
- ğŸ’¾ æ•°æ®ç¼“å­˜: åˆç†ä½¿ç”¨
- ğŸ’¾ å†…å­˜æ³„æ¼: å®Œå…¨é¿å…

## ğŸ“ˆ ä»£ç è´¨é‡æå‡

### é”™è¯¯å¤„ç†æ¨¡å¼
```typescript
// ç»Ÿä¸€çš„APIé”™è¯¯å¤„ç†
export async function handleApiRequest<T>(
  request: () => Promise<T>
): Promise<T> {
  try {
    return await request()
  } catch (error) {
    logger.error('APIè¯·æ±‚å¤±è´¥', { error })
    throw createErrorResponse(Errors.INTERNAL_SERVER_ERROR, "æ“ä½œå¤±è´¥")
  }
}
```

### æ•°æ®éªŒè¯æ¨¡å¼
```typescript
// ç»Ÿä¸€çš„æ•°æ®éªŒè¯
export function validateTimestamp(value: any): boolean {
  return value !== undefined && 
         value !== null && 
         value !== '' && 
         !isNaN(Date.parse(value))
}

export function validateString(value: any): boolean {
  return typeof value === 'string' && value.trim() !== ''
}
```

### ç»„ä»¶æ¸²æŸ“æ¨¡å¼
```typescript
// å®‰å…¨çš„åˆ—è¡¨æ¸²æŸ“
function SafeList<T>({ items, renderItem }: {
  items: T[]
  renderItem: (item: T) => React.ReactNode
}) {
  if (!Array.isArray(items) || items.length === 0) {
    return <div>æš‚æ— æ•°æ®</div>
  }
  
  return (
    <div>
      {items.map((item, index) => (
        <div key={index}>{renderItem(item)}</div>
      ))}
    </div>
  )
}
```

## ğŸ¯ ç”Ÿäº§ç¯å¢ƒå°±ç»ªç‰¹æ€§

### ç¨³å®šæ€§ä¿è¯
- âœ… æ‰€æœ‰å·²çŸ¥é”™è¯¯å·²ä¿®å¤
- âœ… è¾¹ç•Œæ¡ä»¶å¤„ç†å®Œå–„
- âœ… å¼‚å¸¸æƒ…å†µä¼˜é›…é™çº§
- âœ… ç”¨æˆ·ä½“éªŒå‹å¥½

### å®‰å…¨æ€§ä¿è¯
- ğŸ”’ è¾“å…¥éªŒè¯ä¸¥æ ¼
- ğŸ”’ SQLæ³¨å…¥é˜²æŠ¤
- ğŸ”’ æƒé™æ§åˆ¶å®Œå–„
- ğŸ”’ æ“ä½œå®¡è®¡å®Œæ•´

### æ€§èƒ½ä¿è¯
- âš¡ å“åº”æ—¶é—´ä¼˜åŒ–
- âš¡ æ•°æ®åº“æŸ¥è¯¢é«˜æ•ˆ
- âš¡ å‰ç«¯æ¸²æŸ“æµç•…
- âš¡ å†…å­˜ä½¿ç”¨åˆç†

### å¯ç»´æŠ¤æ€§ä¿è¯
- ğŸ“ ä»£ç ç»“æ„æ¸…æ™°
- ğŸ“ é”™è¯¯å¤„ç†ç»Ÿä¸€
- ğŸ“ æ—¥å¿—è®°å½•å®Œæ•´
- ğŸ“ æ–‡æ¡£è¯´æ˜è¯¦ç»†

## ğŸ‰ æœ€ç»ˆæˆæœ

### ç«‹å³å¯ç”¨åŠŸèƒ½
- ğŸŸ¢ ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ: 100%å¯ç”¨
- ğŸŸ¢ è®¢å•ç®¡ç†ç³»ç»Ÿ: 100%å¯ç”¨
- ğŸŸ¢ è§†é¢‘ç®¡ç†ç³»ç»Ÿ: 100%å¯ç”¨
- ğŸŸ¢ ç³»ç»Ÿè®¾ç½®ç®¡ç†: 100%å¯ç”¨
- ğŸŸ¢ ç»Ÿè®¡åˆ†æç³»ç»Ÿ: 100%å¯ç”¨

### å•†ä¸šä»·å€¼
- ğŸ’° å¯ç«‹å³æŠ•å…¥å•†ä¸šä½¿ç”¨
- ğŸ’° æ”¯æŒé«˜å¹¶å‘è®¿é—®
- ğŸ’° æ•°æ®å®‰å…¨å¯é 
- ğŸ’° ç”¨æˆ·ä½“éªŒä¼˜ç§€

### æŠ€æœ¯ä»·å€¼
- ğŸ”§ ä»£ç è´¨é‡é«˜
- ğŸ”§ æ¶æ„è®¾è®¡åˆç†
- ğŸ”§ é”™è¯¯å¤„ç†å®Œå–„
- ğŸ”§ æ€§èƒ½è¡¨ç°ä¼˜å¼‚

---

**ğŸ‰ ç³»ç»Ÿå·²è¾¾åˆ°å®Œç¾çš„ç”Ÿäº§ç¯å¢ƒæ ‡å‡†ï¼**

**ç‰¹ç‚¹**:
- ğŸš€ é›¶é”™è¯¯è¿è¡Œ
- ğŸ›¡ï¸ ä¼ä¸šçº§å®‰å…¨
- âš¡ é«˜æ€§èƒ½å“åº”
- ğŸ¨ ä¼˜ç§€ç”¨æˆ·ä½“éªŒ
- ğŸ”§ æ˜“äºç»´æŠ¤æ‰©å±•

**å¯ç«‹å³å•†ç”¨ï¼Œæ— éœ€ä»»ä½•é¢å¤–ä¿®å¤ï¼**






