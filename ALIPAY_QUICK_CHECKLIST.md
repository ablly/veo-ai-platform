# 支付宝配置快速清单 ⚡

> **目标：** 30分钟内完成支付宝支付配置

---

## 📝 准备阶段（5分钟）

### 材料准备

- [ ] 企业营业执照（扫描件）
- [ ] 企业支付宝账号（已完成企业认证）
- [ ] 法人身份证信息
- [ ] 网站域名：`www.veo-ai.site`

---

## 🔧 配置步骤

### 第1步：创建应用（5分钟）

1. [ ] 访问 https://open.alipay.com 登录

2. [ ] 进入 **控制台** → **应用管理** → **创建应用**

3. [ ] 选择 **网页&移动应用**

4. [ ] 填写应用信息：
   ```
   应用名称：VEO AI视频创作平台
   应用简介：基于AI的专业视频创作平台
   所属行业：互联网软件-在线视频/直播
   ```

5. [ ] 记录 **APPID**（格式：`2021xxxxxxxxxx`）
   ```
   您的APPID：____________________
   ```

---

### 第2步：生成密钥（5分钟）

#### Windows用户

1. [ ] 下载密钥生成工具
   ```
   https://opendocs.alipay.com/common/02kipk
   ```

2. [ ] 运行 `支付宝开放平台开发助手.exe`

3. [ ] 选择配置：
   - 加密类型：**RSA2(SHA256)**
   - 密钥格式：**PKCS1（非JAVA适用）**
   - 密钥长度：**2048**

4. [ ] 点击 **生成密钥**

5. [ ] 保存文件：
   - `应用私钥.txt` → 妥善保管（不要泄露！）
   - `应用公钥.txt` → 需要上传到支付宝

#### Mac/Linux用户

```bash
# 生成应用私钥
openssl genrsa -out app_private_key.pem 2048

# 提取应用公钥
openssl rsa -in app_private_key.pem -pubout -out app_public_key.pem

# 查看应用私钥（去掉头尾）
cat app_private_key.pem | grep -v "BEGIN" | grep -v "END" | tr -d '\n'

# 查看应用公钥（去掉头尾）
cat app_public_key.pem | grep -v "BEGIN" | grep -v "END" | tr -d '\n'
```

---

### 第3步：配置应用（5分钟）

1. [ ] 进入 **应用详情** → **开发设置**

2. [ ] 设置 **接口加签方式**：
   - 点击 **设置** → 选择 **公钥**
   - 粘贴 `应用公钥.txt` 的内容（去掉头尾）
   - 点击 **保存**

3. [ ] **复制支付宝公钥**（页面显示的，非常重要！）
   ```
   支付宝公钥：____________________
   ```

4. [ ] 配置 **应用网关**（回调地址）：
   ```
   https://www.veo-ai.site/api/payment/alipay/notify
   ```

5. [ ] 点击 **保存**

---

### 第4步：申请产品能力（3分钟提交，1-3天审核）

1. [ ] 进入 **功能列表** → 找到 **电脑网站支付**

2. [ ] 点击 **申请**

3. [ ] 填写申请信息：
   ```
   应用场景：在线视频服务
   
   业务描述：
   VEO AI是一款基于人工智能的视频创作平台，用户可以通过
   平台生成AI视频，并购买积分套餐以使用更多服务。用户在
   选择套餐后，使用支付宝完成在线支付。
   
   网站地址：https://www.veo-ai.site
   ```

4. [ ] 上传截图（4-6张）：
   - 首页截图
   - 套餐定价页面
   - 视频生成页面
   - 服务条款页面
   - 营业执照

5. [ ] 点击 **提交审核**

6. [ ] 等待审核（1-3个工作日）

---

### 第5步：配置EdgeOne环境变量（5分钟）

⚠️ **重要：审核通过后再进行此步骤！**

1. [ ] 登录EdgeOne控制台
   ```
   https://console.cloud.tencent.com/edgeone
   ```

2. [ ] 进入 **Pages服务** → 选择项目 → **设置** → **环境变量**

3. [ ] 添加以下6个环境变量：

   | 变量名 | 变量值 | 从哪里获取 |
   |--------|--------|----------|
   | `ALIPAY_APP_ID` | `您的APPID` | 应用详情页 |
   | `ALIPAY_PRIVATE_KEY` | `应用私钥（一行，无头尾）` | `应用私钥.txt` |
   | `ALIPAY_PUBLIC_KEY` | `支付宝公钥（一行，无头尾）` | 应用详情→开发设置 |
   | `ALIPAY_GATEWAY` | `https://openapi.alipay.com/gateway.do` | 固定值 |
   | `ALIPAY_SIGN_TYPE` | `RSA2` | 固定值 |
   | `ALIPAY_CHARSET` | `utf-8` | 固定值 |

4. [ ] 点击 **保存**

5. [ ] 等待EdgeOne重新部署（2-5分钟）

---

### 第6步：测试支付（5分钟）

1. [ ] 访问 https://www.veo-ai.site

2. [ ] 登录账号

3. [ ] 进入 **套餐定价** 页面

4. [ ] 选择最便宜的套餐（测试用）

5. [ ] 点击 **立即购买**

6. [ ] 检查是否跳转到支付宝收银台

7. [ ] 完成支付

8. [ ] 检查：
   - [ ] 支付成功后是否跳转回网站
   - [ ] 积分是否正确到账
   - [ ] 订单状态是否更新

---

## 📊 配置信息汇总表

请将您的配置信息填写在这里，方便日后查询：

```
==================== 支付宝应用信息 ====================

APPID：_______________________________________

应用名称：VEO AI视频创作平台

应用类型：网页&移动应用

创建时间：_______________

==================== 密钥信息 ====================

应用私钥（ALIPAY_PRIVATE_KEY）：
（保存在安全的地方，不要泄露！）
_________________________________________________

应用公钥（已上传到支付宝）：
_________________________________________________

支付宝公钥（ALIPAY_PUBLIC_KEY）：
_________________________________________________

==================== 回调地址 ====================

应用网关（异步通知）：
https://www.veo-ai.site/api/payment/alipay/notify

同步返回地址：
https://www.veo-ai.site/credits

==================== 产品能力 ====================

电脑网站支付：
  申请时间：_______________
  审核状态：[ ] 审核中  [ ] 已通过  [ ] 已拒绝
  通过时间：_______________
  签约时间：_______________

==================== EdgeOne配置 ====================

环境变量配置完成：[ ] 是  [ ] 否

部署完成时间：_______________

测试支付完成：[ ] 是  [ ] 否

==================== 备注 ====================

_________________________________________________
_________________________________________________
_________________________________________________

```

---

## ⚠️ 重要提示

### 密钥安全

- ✅ 应用私钥必须妥善保管，不要泄露
- ✅ 不要将私钥提交到GitHub或其他公开平台
- ✅ 定期更换密钥（建议每年更换一次）
- ✅ 如果私钥泄露，立即在支付宝平台删除旧公钥并重新生成

### 密钥格式

**应用私钥和支付宝公钥在配置到EdgeOne时，需要：**

1. 去掉头部：`-----BEGIN RSA PRIVATE KEY-----`
2. 去掉尾部：`-----END RSA PRIVATE KEY-----`
3. 去掉所有换行符，保持一行

**示例：**

❌ **错误格式（包含头尾和换行）：**
```
-----BEGIN RSA PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEF
AASCBKcwggSjAgEAAoIBAQC...
...
-----END RSA PRIVATE KEY-----
```

✅ **正确格式（一行，无头尾）：**
```
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC...
```

### 审核注意事项

1. **网站必须可访问**
   - 确保 `https://www.veo-ai.site` 可以正常打开
   - 确保HTTPS证书有效

2. **业务描述要详细**
   - 说明用户如何使用平台
   - 说明支付场景和流程

3. **截图要清晰**
   - 包含网站URL栏
   - 展示核心业务功能
   - 至少4张不同页面

4. **营业执照要清晰**
   - 确保在有效期内
   - 扫描件或高清照片

---

## 🆘 常见问题快速解决

| 问题 | 解决方法 |
|------|---------|
| **审核被拒绝** | 根据拒绝原因修改后重新提交，常见原因：网站无法访问、截图不清晰、业务描述不详细 |
| **支付时报错"应用未签约"** | 检查"电脑网站支付"是否审核通过并签约 |
| **收不到回调通知** | 检查应用网关地址是否正确，检查EdgeOne日志 |
| **签名验证失败** | 检查应用私钥和支付宝公钥格式是否正确（一行，无头尾） |
| **环境变量不生效** | 等待EdgeOne重新部署（2-5分钟），清除浏览器缓存 |

---

## 📞 需要帮助？

- **支付宝文档：** https://opendocs.alipay.com/open/270
- **支付宝客服：** 95188（商家服务）
- **技术论坛：** https://forum.alipay.com

---

## ✅ 完成确认

全部配置完成后，请确认：

- [ ] 支付宝应用创建成功
- [ ] 密钥生成并配置完成
- [ ] 产品能力审核通过
- [ ] EdgeOne环境变量配置完成
- [ ] 测试支付成功
- [ ] 积分到账正常

**🎉 恭喜！支付宝支付配置完成！**

---

**文档版本：** v1.0  
**更新时间：** 2025-10-29  


